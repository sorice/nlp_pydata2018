<!DOCTYPE html>
<html lang="en" class="js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

			<meta charset="utf-8">
	<meta name="google-site-verification" content="XzhxEv9n6_QIITfsjN1nNssRwvQ2stqTz70CuXeu-94">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="initial-scale=1.0; user-scalable=yes;">
	<meta name="p:domain_verify" content="4fcf9878caa9f2ce8dbe0b8162fcb9c5">
	
	
		
			<!--[if IE 7 ]>
	<link rel="stylesheet" href="styles/fonts/css/binpress-ie7.css" type="text/css" media="all" />
	<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	    <meta property="og:type" content="website">
<meta property="og:url" content="http://www.binpress.com/tutorial/manipulating-pdfs-with-python/167">
<meta property="og:image" content="http://www.binpress.com/images/logo/open-graph.png">
<meta property="og:site_name" content="Binpress">
<meta property="fb:admins" content="617568869,537023091">
<meta property="fb:app_id" content="172491746142461">
<meta name="description" content="There are some nasty PDFs out there, but there are several tools you can use to get what you need from them. Python enables you to get inside and scrape, split, merge, delete, and crop just about whatever you find, and I'll show you how.">
<meta property="og:description" content="There are some nasty PDFs out there, but there are several tools you can use to get what you need from them. Python enables you to get inside and scrape, split, merge, delete, and crop just about whatever you find, and I'll show you how.">
<meta property="og:title" content="Manipulating PDFs with Python | Python">		
			
	
	<link href="https://plus.google.com/115913168422804876359" rel="publisher">
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">	<title>Manipulating PDFs with Python - Tutorial - Binpress</title><div style="width: 1px; height: 1px; display: inline; position: absolute;"><img style="border-style: none;" alt="" src="out" height="1" width="1">
<img style="border-style: none;" alt="" src="out_001.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_002.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_003.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_004.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_005.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_006.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="out_007.dat" height="1" width="1">
<img style="border-style: none;" alt="" src="untitled" height="1" width="1">
<img src="seg" height="1" width="1">
<img style="border-style: none;" alt="" src="untitled_001.dat" height="1" width="1">
<img src="seg_001.dat" height="1" width="1">
</div>
<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body><div id="olark" style="display: none;"><olark><iframe src="index_1.html" id="olark-loader" frameborder="0"></iframe></olark></div>
	<div id="container">
		<div id="header">
	<div class="width">

		<div class="nav">
			<div class="links-wrap">
				<div class="links">
					<a href="https://www.binpress.com/blog"><span>Blog</span></a>
					<a href="https://www.binpress.com/browse"><span>Marketplace</span></a>
										<a href="https://www.binpress.com/features/store"><span>Features</span></a>
					<a href="https://www.binpress.com/pricing"><span>Pricing</span></a>
					<a href="https://www.binpress.com/contact"><span>Contact</span></a>
															<a href="https://www.binpress.com/login"><span>Login</span></a>
									</div>
			</div>
						
								<a class="button" href="https://www.binpress.com/register">Create your store</a>
										<a class="show-menu icon-menu button"></a>
		</div>
		<a id="logo" href="https://www.binpress.com/" title="Homepage - Binpress"><img src="logo.png" alt="Binpress">
			<br><small>Your own digital store</small></a>
	</div>
</div>
		<div id="body" class="width">
			<div class="tutorial">
	<ul class="tutorials-nav">
	<li>
		<span class="title"><i class="icon-code"></i>Languages</span>
		<ul>
						<li><a href="https://www.binpress.com/tutorials?language=c"><small>(12)</small>C/C++</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=csharp"><small>(4)</small>C#</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=go"><small>(1)</small>Go</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=java"><small>(10)</small>Java</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=javascript"><small>(14)</small>JavaScript</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=lua"><small>(1)</small>Lua</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=objective-c"><small>(77)</small>Objective-C</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=php"><small>(8)</small>PHP</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=python" class="selected"><small>(10)</small>Python</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=ruby"><small>(1)</small>Ruby</a></li>
						<li><a href="https://www.binpress.com/tutorials?language=swift"><small>(3)</small>Swift</a></li>
					</ul>
	</li>

	<li>
		<span class="title"><i class="icon-list-bullet"></i>Tags</span>
		<ul>
						<li><a href="https://www.binpress.com/tutorials?tag=ios"><small>(77)</small>ios</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=objective-c"><small>(71)</small>objective-c</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=os+x"><small>(65)</small>os x</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=game+development"><small>(16)</small>game development</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=iPhone"><small>(13)</small>iPhone</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=games"><small>(13)</small>games</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=sfml"><small>(11)</small>sfml</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=c%2B%2B"><small>(11)</small>c++</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=video+games"><small>(11)</small>video games</a></li>
						<li><a href="https://www.binpress.com/tutorials?tag=gaming"><small>(11)</small>gaming</a></li>
					</ul>
	</li>
</ul>	<div class="one-col">
		<h1>Manipulating PDFs with Python</h1>
		<div class="meta">
			<a href="https://www.binpress.com/tutorial/manipulating-pdfs-with-python/167#comments" class="grey-button icon-comment-1 addcomment">
								4							</a>
			<span class="avatar tiniest color3"><img src="54a3f1ba4fe36ca8f3148c0c8a041d36" alt=""><span>TA</span></span>			<a href="https://www.binpress.com/profile/tim-arnold/38955">Tim Arnold</a>
				
							<span class="time">Nov 6, 2014</span>
									
		</div>
		
		
		<div class="tags">
			<a href="https://www.binpress.com/tutorials?language=python"><i class="icon-code"></i>Python</a><a href="https://www.binpress.com/tutorials?tag=pdf"><i class="icon-list-bullet"></i>pdf</a><a href="https://www.binpress.com/tutorials?tag=python"><i class="icon-list-bullet"></i>python</a>		</div>
		<div class="markdown">
			<p>PDF documents are beautiful things, but that beauty is often only skin deep. Inside, they might have any number of structures that are difficult to understand and exasperating to get at. The PDF reference specification (ISO 32000-1) provides rules, but it's programmers who follow them, and they, like all programmers, are a creative bunch.</p>

<p>That means that in the end, a beautiful PDF document is really meant to be read and its internals are not to be messed with. Well, we are programmers too, and we are a creative bunch, so we'll see how we can get at those internals.</p>

<p>Still, the best advice if you have to extract or add information to a PDF is: <strong>don't do it</strong>. Well, don't do it if there is any way you can get access to the information further upstream. If you want to scrape that spreadsheet data in a PDF, see if you can get access to it before it became part of the PDF. Chances are, now that it's inside the PDF, it's just a bunch of lines and numbers  with no connection to its former structure of cells, formats, and headings. </p>

<p>If you cannot get access to the information further upstream, this tutorial will show you some of the ways you can get inside the PDF using Python.</p>

<h1>Survey of Tools</h1>

<p>There are several Python packages that can help. The following list displays some of the most popular ones, although undoubtedly I've omitted some tools.</p>

<p><code>pdfrw</code>: Read and write PDF files; watermarking, copying images from one PDF to another. Includes sample code. MIT License.  Recently updated to Python 3. Check out <a href="https://www.binpress.com/tutorial/manipulating-pdfs-with-python/171">this tutorial by pdfrw's creator</a>, which mirrors the examples in this article.</p>

<p><code>slate</code>
 : Active development. Simplifies extracting text from PDF files. Wrapper around <code>PDFMiner</code>. Includes documentation on GitHub and PyPI. Python 2.6. GPL License.  <a href="https://github.com/timClicks/slate">repo</a></p>

<p><code>PDFQuery</code> 
 : Active development. PDF scraping with Jquery or XPath syntax. Requires <code>PDFMiner</code>, <code>pyquery</code> and <code>lxml</code> libraries. Includes sample code, documentation. Seems to be Python 2.x. MIT License. <a href="https://github.com/jcushman/pdfquery">repo</a></p>

<p><code>PDFMiner</code>
 : Active development. Extracting text, images, object coordinates, metadata from PDF files. Pure Python. Includes sample code and command line interface; Google group and documentation. Python 2.x only. MIT License. <a href="https://github.com/euske/pdfminer/">repo</a></p>

<p><code>PyPDF2</code>
 : Active development. Split, merge, crop, etc. of PDF files. Pure Python. Includes sample code and command line interface, documentation. Python 2 and 3. BSD License. <a href="https://github.com/mstamy2/PyPDF2">repo</a></p>

<h2>Related Tools</h2>

<p>This article focuses on extracting information with PDFMiner and manipulating PDFs with PyPDF2.</p>

<p>There are other Python projects for creating PDFs, and several non-Python tools available for manipulating PDFs. If none of the Python solutions described here fit your situation, see the section [Other Tools][] for more information.</p>

<h1>Extracting: PDFMiner</h1>

<p>The <strong>PDFMiner</strong> library excels at extracting data and coordinates from a PDF. In most cases, you can use the included command-line scripts to extract text and images (<code>pdf2txt.py</code>) or find objects and their coordinates (<code>dumppdf.py</code>). If you're dealing with a particularly nasty PDF and you need to get more detailed , you can import the package and use it as library. Install it with <code>pip</code>.</p>

<h2>The <code>pdf2txt.py</code> command</h2>

<p>The package includes the <code>pdf2txt.py</code> command-line command, which you can use to extract text and images. The command supports many options and is very flexible. Some popular options are shown below. See the usage information for complete details.</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">pdf2txt</span><span class="pun">.</span><span class="pln">py </span><span class="pun">[</span><span class="pln">options</span><span class="pun">]</span><span class="pln"> filename</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L1"><code><span class="pln"></span><span class="typ">Options</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">o output file name</span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">p comma</span><span class="pun">-</span><span class="pln">separated list of page numbers to extract</span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">t output format </span><span class="pun">(</span><span class="pln">text</span><span class="pun">/</span><span class="pln">html</span><span class="pun">/</span><span class="pln">xml</span><span class="pun">/</span><span class="pln">tag</span><span class="pun">[</span><span class="kwd">for</span><span class="pln"> </span><span class="typ">Tagged</span><span class="pln"> </span><span class="typ">PDFs</span><span class="pun">])</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">O dirname </span><span class="pun">(</span><span class="pln">triggers extraction of images </span><span class="kwd">from</span><span class="pln"> PDF </span><span class="kwd">into</span><span class="pln"> directory</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">P password</span></code></li></ol></pre>

<p>That's right, you can even use the command to convert a PDF to HTML or XML! For example, say you want the HTML version of the first and third pages of your PDF, including images.</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">pdf2txt</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">O myoutput </span><span class="pun">-</span><span class="pln">o myoutput</span><span class="pun">/</span><span class="pln">myfile</span><span class="pun">.</span><span class="pln">html </span><span class="pun">-</span><span class="pln">t html </span><span class="pun">-</span><span class="pln">p </span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pln"> myfile</span><span class="pun">.</span><span class="pln">pdf</span></code></li></ol></pre>

<p>Note that the package cannot recognize text drawn as images because that would require optical character recognition. It does extract the corresponding locations, font names, font sizes, etc., for each bit of text. Often this is good enough--you can extract the text and use typical Python patterns for text processing to get the text or data into a usable form.</p>

<h2>The <code>dumppdf.py</code> command</h2>

<p>The package also includes the <code>dumppdf.py</code> command-line command, which you can use to find the objects and their coordinates inside a PDF file.</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">dumppdf</span><span class="pun">.</span><span class="pln">py </span><span class="pun">[</span><span class="pln">options</span><span class="pun">]</span><span class="pln"> filename</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L1"><code><span class="pln"></span><span class="typ">Options</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">a </span><span class="kwd">dump</span><span class="pln"> all objects</span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">p comma</span><span class="pun">-</span><span class="pln">separated list of page numbers to extract</span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">i </span><span class="kwd">object</span><span class="pln"> id</span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">E dirname </span><span class="pun">(</span><span class="pln">extract embedded files </span><span class="kwd">from</span><span class="pln"> the PDF </span><span class="kwd">into</span><span class="pln"> directory</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">T </span><span class="kwd">dump</span><span class="pln"> the table of contents </span><span class="pun">(</span><span class="pln">bookmark outlines</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; </span><span class="pun">-</span><span class="pln">p password</span></code></li></ol></pre>

<p>This is very useful when you have a problematic PDF and you want to know the exact object IDs that it contains. For example, you might need to know the object ID corresponding to an image in the PDF so you can extract only that image. Here's an example:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">dumppdf</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">a filename</span><span class="pun">.</span><span class="pln">pdf </span><span class="pun">|</span><span class="pln"> more</span><br></code></li><li class="L1"><code><span class="pln"></span><span class="com"># search for the string 'Image' and find the ID; '33' for example.</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">dumppdf</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">i </span><span class="lit">33</span><span class="pln"> </span><span class="pun">-</span><span class="pln">r filename</span><span class="pun">.</span><span class="pln">pdf </span><span class="pun">&gt;</span><span class="pln"> myimage</span><span class="pun">.</span><span class="pln">jpg</span></code></li></ol></pre>

<p>You run the command with the <code>-a</code> option first so you can review the objects and their IDs, find the object you want (images have a <code>SubType</code> of <code>Image</code>), then re-run the command with the <code>-i</code> option to extract only that object.</p>

<h2>Use as a Library</h2>

<p>If you're writing Python code and you don't want to shell out to the command line with <code>os.system</code> or <code>subprocess</code>, use the package as a library. For example, to extract text from a PDF:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> cStringIO </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">StringIO</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">pdfinterp </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PDFResourceManager</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PDFPageInterpreter</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">converter </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">TextConverter</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">layout </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LAParams</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">pdfpage </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PDFPage</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><span class="kwd">def</span><span class="pln"> convert</span><span class="pun">(</span><span class="pln">fname</span><span class="pun">,</span><span class="pln"> pages</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> pages</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; pagenums </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; pagenums </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">(</span><span class="pln">pages</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; output </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringIO</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; manager </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PDFResourceManager</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; converter </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TextConverter</span><span class="pun">(</span><span class="pln">manager</span><span class="pun">,</span><span class="pln"> output</span><span class="pun">,</span><span class="pln"> laparams</span><span class="pun">=</span><span class="typ">LAParams</span><span class="pun">())</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; interpreter </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PDFPageInterpreter</span><span class="pun">(</span><span class="pln">manager</span><span class="pun">,</span><span class="pln"> converter</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; infile </span><span class="pun">=</span><span class="pln"> file</span><span class="pun">(</span><span class="pln">fname</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> page </span><span class="kwd">in</span><span class="pln"> </span><span class="typ">PDFPage</span><span class="pun">.</span><span class="pln">get_pages</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">,</span><span class="pln"> pagenums</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; interpreter</span><span class="pun">.</span><span class="pln">process_page</span><span class="pun">(</span><span class="pln">page</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp; infile</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln">&nbsp; &nbsp; converter</span><span class="pun">.</span><span class="pln">close</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; text </span><span class="pun">=</span><span class="pln"> output</span><span class="pun">.</span><span class="pln">getvalue</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; output</span><span class="pun">.</span><span class="pln">close</span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> text </span></code></li></ol></pre>

<p>The <code>convert</code> function is called with the name of the PDF file in question, and optionally, a list of pages to process. By default, all pages are converted to text. The function returns a string containing the text. To retrieve the text extracted from <code>myfile.pdf</code> on pages 6 and 8, call the function as follows (internal page numbering starts at zero).</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">convert</span><span class="pun">(</span><span class="str">'myfile.pdf'</span><span class="pun">,</span><span class="pln"> pages</span><span class="pun">=[</span><span class="lit">5</span><span class="pun">,</span><span class="lit">7</span><span class="pun">])</span></code></li></ol></pre>

<p>PDFMiner provides functions to access the document's table of contents. If your PDF has bookmarks or "Outlines", you can extract the table of contents with this code snippet:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="com">#!python</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">pdfparser </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PDFParser</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> pdfminer</span><span class="pun">.</span><span class="pln">pdfdocument </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PDFDocument</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln"></span><span class="kwd">def</span><span class="pln"> get_toc</span><span class="pun">(</span><span class="pln">pdf_path</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; infile </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">pdf_path</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; parser </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PDFParser</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; document </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PDFDocument</span><span class="pun">(</span><span class="pln">parser</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; toc </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">level</span><span class="pun">,</span><span class="pln">title</span><span class="pun">,</span><span class="pln">dest</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">structelem</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">get_outlines</span><span class="pun">():</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; toc</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">level</span><span class="pun">,</span><span class="pln"> title</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> toc</span></code></li></ol></pre>

<p><strong>Note:</strong> If you change line 11 to read <code>toc.append((level, title, a.resolve()))</code>, the resulting list will contain the actual internal destinations for bookmarks. A typical entry looks like this:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> u</span><span class="str">'Other Commands'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">'S'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">/</span><span class="typ">GoTo</span><span class="pun">,</span><span class="pln"> </span><span class="str">'D'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'section.8'</span><span class="pun">})</span></code></li></ol></pre>

<p>...where the section "Other Commands" is a first level section and it is the 8th section in the PDF. You can use this information to construct an HTML URL that opens the PDF at that destination. In this example, the URL would look like this:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"path/to/myfile.pdf#section.8"</span><span class="tag">&gt;</span><span class="pln">link text</span><span class="tag">&lt;/a&gt;</span></code></li></ol></pre>

<p>When you follow the URL, the browser opens the PDF at the location of the section titled "Other Commands."</p>

<p>How do you know how to piece everything together, what with the manager, the parser, the document, etc.? The documentation for the package is helpful, but in addition, the source code for the command-line commands is straightforward and shows how you can configure your own code. The source for the scripts reside in a subdirectory called <code>tools</code>. In fact, the entire source code is readable and provides good, Pythonic, examples.</p>

<h1>Manipulating: PyPDF2</h1>

<p>You can manipulate PDF files in a variety of ways using the pure-Python PyPDF2 toolkit. The original <strong>pyPDF</strong> library is officially no longer being developed but the <strong>pyPDF2</strong> library has taken up the project under the new name and continues to develop and enhance the library. The development team is dedicated to keeping the project backward compatible. Install it with <code>pip</code>.</p>

<p>Want to merge two PDFs? Merge can mean a couple of things. You can merge, in the sense of inserting the contents of one PDF <em>after</em> the content of another, or you can merge by applying one PDF page <em>on top of</em> another. </p>

<h2>Merge (layer)</h2>

<p>For an example of the latter case, if you have a one-page PDF containing a watermark, you can layer it onto each page of another PDF.</p>

<p>Say you've created a PDF with transparent watermark text (using Photoshop, Gimp, or LaTeX). If this PDF is named <code>wmark.pdf</code>, the following python code will stamp each page of the target PDF with the watermark.</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln">output </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">ipdf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="str">'sample2e.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">wpdf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="str">'wmark.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">watermark </span><span class="pun">=</span><span class="pln"> wpdf</span><span class="pun">.</span><span class="pln">getPage</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln"></span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">ipdf</span><span class="pun">.</span><span class="pln">getNumPages</span><span class="pun">()):</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; page </span><span class="pun">=</span><span class="pln"> ipdf</span><span class="pun">.</span><span class="pln">getPage</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; page</span><span class="pun">.</span><span class="pln">mergePage</span><span class="pun">(</span><span class="pln">watermark</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp; output</span><span class="pun">.</span><span class="pln">addPage</span><span class="pun">(</span><span class="pln">page</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'newfile.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp;output</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span></code></li></ol></pre>

<p>If your watermark PDF is not transparent it will hide the underlying text. In that case, make sure the content of the watermark displays on the header or margin so that when it is merged, no text is masked. For example, you can use this technique to stamp a logo or letterhead on each page of the target PDF.</p>

<h2>Merge (append)</h2>

<p>This snippet takes all the PDFs in a subdirectory named <code>mypdfs</code> and puts them in name-sorted order into a new PDF called <code>output.pdf</code></p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileMerger</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="kwd">import</span><span class="pln"> os</span><br></code></li><li class="L2"><code><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">merger </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileMerger</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">files </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">x </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> os</span><span class="pun">.</span><span class="pln">listdir</span><span class="pun">(</span><span class="str">'mypdfs'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">endswith</span><span class="pun">(</span><span class="str">'.pdf'</span><span class="pun">)]</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln"></span><span class="kwd">for</span><span class="pln"> fname </span><span class="kwd">in</span><span class="pln"> sorted</span><span class="pun">(</span><span class="pln">files</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; merger</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="pln">os</span><span class="pun">.</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">'mypdfs'</span><span class="pun">,</span><span class="pln"> fname</span><span class="pun">),</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)))</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">merger</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">"output.pdf"</span><span class="pun">)</span></code></li></ol></pre>

<h2>Delete</h2>

<p>If you want to delete pages, iterate over the pages in your source PDF and skip over the pages to be deleted as you write your new PDF. For example, if you want to get rid of blank pages in <code>source.pdf</code>:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln">infile </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="str">'source.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">output </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln"></span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">.</span><span class="pln">getNumPages</span><span class="pun">()):</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; p </span><span class="pun">=</span><span class="pln"> infile</span><span class="pun">.</span><span class="pln">getPage</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">getContents</span><span class="pun">():</span><span class="pln"> </span><span class="com"># getContents is None if &nbsp;page is blank</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; output</span><span class="pun">.</span><span class="pln">addPage</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln"></span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'newfile.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp;output</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span></code></li></ol></pre>

<p>Since blank pages are not added to the output file, the result is that the new output file is a copy of the source but with no blank pages.</p>

<h2>Split</h2>

<p>You want to split one PDF into separate one-page PDFs. Create a new file for each page and write it to disk as you iterate through the source PDF.</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pln"> </span><br></code></li><li class="L1"><code><span class="pln">infile </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="str">'source.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">.</span><span class="pln">getNumPages</span><span class="pun">()):</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; p </span><span class="pun">=</span><span class="pln"> infile</span><span class="pun">.</span><span class="pln">getPage</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; outfile </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln">&nbsp; &nbsp; outfile</span><span class="pun">.</span><span class="pln">addPage</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'page-%02d.pdf'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; outfile</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span></code></li></ol></pre>

<h2>Slices</h2>

<p>You can even operate on slices of a source PDF, where each item in the slice is a page.</p>

<p>Say you have two PDFs resulting from scanning odd and even pages of a source document. You can merge them together, interleaving the pages as follows:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="com">#!python</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pln"> </span><br></code></li><li class="L2"><code><span class="pln">even </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="str">'even.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">odd </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileReader</span><span class="pun">(</span><span class="pln">open</span><span class="pun">(</span><span class="str">'odd.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">))</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">all </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileWriter</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">all</span><span class="pun">.</span><span class="pln">addBlankPage</span><span class="pun">(</span><span class="lit">612</span><span class="pun">,</span><span class="pln"> </span><span class="lit">792</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln"></span><span class="kwd">for</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">y </span><span class="kwd">in</span><span class="pln"> zip</span><span class="pun">(</span><span class="pln">odd</span><span class="pun">.</span><span class="pln">pages</span><span class="pun">,</span><span class="pln"> even</span><span class="pun">.</span><span class="pln">pages</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; all</span><span class="pun">.</span><span class="pln">addPage</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; all</span><span class="pun">.</span><span class="pln">addPage</span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="kwd">while</span><span class="pln"> all</span><span class="pun">.</span><span class="pln">getNumPages</span><span class="pun">()</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; all</span><span class="pun">.</span><span class="pln">addBlankPage</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln"></span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'all.pdf'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; all</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span></code></li></ol></pre>

<p>The first <code>addBlankPage</code> (line 5) insures that the output PDF begins with a blank page so that the first content page is on the right-hand side. Note that, when you add a blank page, the default page dimensions are set to the previous page. In this case, because there is no previous page, you must set the dimensions explicitly; 8.5 inches is 612 points, 11 inches is 792 points).</p>

<p>Alternatively, you might add a title page as the first page. In any case, putting the first content page on the right-hand side (odd numbered) is useful when your PDFs are laid out for a two-page (book-like) spread.</p>

<p>The last <code>addBlankPage</code> sequence (lines 11-12) insures there is an even number of pages in the final PDF. Like the first <code>addBlankPage</code>, this is an optional step, but could be important depending on how the final PDF will be used. For example, a print shop will appreciate that your PDFs do not end on an odd page.</p>

<h2>Metadata</h2>

<p>You can set your own metadata in a PDF:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="kwd">from</span><span class="pln"> </span><span class="typ">PyPDF2</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">PdfFileMerger</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><span class="kwd">def</span><span class="pln"> add_metadata</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">):</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">&nbsp; &nbsp; merger </span><span class="pun">=</span><span class="pln"> </span><span class="typ">PdfFileMerger</span><span class="pun">()</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'%s.pdf'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> name</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f0</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; merger</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">f0</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">&nbsp; &nbsp; merger</span><span class="pun">.</span><span class="pln">addMetadata</span><span class="pun">(</span><span class="pln">data</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="str">'%s_update.pdf'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> name</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> f1</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; merger</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">f1</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln">metadata </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">u</span><span class="str">'/hey'</span><span class="pun">:</span><span class="pln">u</span><span class="str">'there'</span><span class="pun">,</span><span class="pln"> u</span><span class="str">'/la'</span><span class="pun">:</span><span class="str">'deedah'</span><span class="pun">}</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">add_metadata</span><span class="pun">(</span><span class="str">'myfile'</span><span class="pun">,</span><span class="pln"> metadata</span><span class="pun">)</span></code></li></ol></pre>

<p>The function <code>add_metadata</code> opens the source PDF file and appends it to a new PdfFileMerger instance, resulting in a copy of the original PDF. Then it adds a special dictionary of key-value pairs into the new PDF metadata dictionary and writes the new PDF out to disk.  The dictionary keys and values are unicode strings; also, the <code>key</code> string begins with a forward slash.</p>

<p>Why would you want to add metadata to a PDF? One situation is when you are processing PDFs as part of a larger workflow in which each PDF file must be processed exactly once. In that case, when you open a file for processing, you first check for the custom metadata key; if it is not present, you add the key and continuing processing the file. If it's already present, the file has already been processed, so you skip it and continue with the next file.</p>

<h2>Other Operations</h2>

<p>With the <strong>PyPDF2</strong> package, you can also crop pages, add Javascript code, encrypt, rotate, scale, and transform pages. The documentation covers these uses and the sample code that comes with the package shows you how to do each operation.</p>

<p>The distribution contains a subdirectory called <code>Sample_Code</code> with several scripts that show you how. The script <code>pdfcat</code> is particularly interesting as it enables you to concatenate specified pages from multiple PDF files into one single PDF. For example (from the <code>pdfcat</code> documentation):</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">pdfcat </span><span class="pun">-</span><span class="pln">o output</span><span class="pun">.</span><span class="pln">pdf head</span><span class="pun">.</span><span class="pln">pdf content</span><span class="pun">.</span><span class="pln">pdf </span><span class="pun">:</span><span class="lit">6</span><span class="pln"> </span><span class="lit">7</span><span class="pun">:</span><span class="pln"> tail</span><span class="pun">.</span><span class="pln">pdf </span><span class="pun">-</span><span class="lit">1</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln">&nbsp; &nbsp; </span><span class="typ">Concatenate</span><span class="pln"> all of head</span><span class="pun">.</span><span class="pln">pdf</span><span class="pun">,</span><span class="pln"> all but page seven of content</span><span class="pun">.</span><span class="pln">pdf</span><span class="pun">,</span><span class="pln"> </span><br></code></li><li class="L2"><code><span class="pln">&nbsp; &nbsp; </span><span class="kwd">and</span><span class="pln"> the </span><span class="kwd">last</span><span class="pln"> page of tail</span><span class="pun">.</span><span class="pln">pdf</span><span class="pun">,</span><span class="pln"> producing output</span><span class="pun">.</span><span class="pln">pdf</span><span class="pun">.</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">pdfcat chapter</span><span class="pun">*.</span><span class="pln">pdf </span><span class="pun">&gt;</span><span class="pln">book</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L5"><code><span class="pln">&nbsp; &nbsp; </span><span class="typ">You</span><span class="pln"> can specify the output file </span><span class="kwd">by</span><span class="pln"> redirection</span><span class="pun">.</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln">pdfcat chapter</span><span class="pun">?.</span><span class="pln">pdf chapter10</span><span class="pun">.</span><span class="pln">pdf </span><span class="pun">&gt;</span><span class="pln">book</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L8"><code><span class="pln">&nbsp; &nbsp; </span><span class="typ">In</span><span class="pln"> </span><span class="kwd">case</span><span class="pln"> you don</span><span class="str">'t want chapter 10 before chapter 2.</span></code></li></ol></pre>

<h1>Other Tools</h1>

<p>If you commonly deal with PDFs, you need a deep toolbox to turn to. In addition to the tools Python provides for manipulating PDFs, the following libraries, packages, and programs enable you to do other types of tasks.</p>

<p><code>reportlab</code>
: Python package. Create PDF documents as well as vector and bitmap images. <a href="http://www.reportlab.com/opensource/">info</a></p>

<p><code>pdftk</code>
: GUI and command line. Merge, split PDF files, and more. <a href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/">info</a></p>

<p><code>fdfgen</code>
: Python package. Generates an <code>FDF</code> file containing form data that can be used with <code>pdftk</code> to populate a PDF form. <a href="https://github.com/ccnmtl/fdfgen/">repo</a></p>

<p><code>qpdf</code>
: C++ library and program suite. Transforms PDF files. Useful for linearizing/optimizing uncompressing, and encryption. <a href="http://qpdf.sourceforge.net/">repo</a></p>

<p><code>ghostscript</code>
: Interpreter for Postscript and PDF. <a href="http://www.ghostscript.com/">info</a>. <a href="http://www.ghostscript.com/doc/9.15/Use.htm">Command-line info</a></p>

<p><code>XPDF</code>
: Open source project. Contains several useful tools such as <code>pdffonts</code> and <code>pdfinfo</code>. <a href="http://www.foolabs.com/xpdf/">repo</a></p>

<p><code>pdffonts</code>
: lists fonts used in a PDF file including information on font type, whether the font is embedded, etc. Part of the open-source <code>Xpdf</code> project. Licensed under GPL v2.</p>

<p>Example:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">pdffonts filename</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L1"><code><span class="pln">name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;emb </span><span class="kwd">sub</span><span class="pln"> uni </span><span class="kwd">object</span><span class="pln"> ID</span><br></code></li><li class="L2"><code><span class="pln"></span><span class="pun">-------------------------------</span><span class="pln"> </span><span class="pun">-------------</span><span class="pln"> </span><span class="pun">---</span><span class="pln"> </span><span class="pun">---</span><span class="pln"> </span><span class="pun">---</span><span class="pln"> </span><span class="pun">---------</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln">LFIGJB</span><span class="pun">+</span><span class="typ">ArialMT</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">Type</span><span class="pln"> </span><span class="lit">1C</span><span class="pln"> &nbsp; &nbsp; &nbsp; yes yes </span><span class="kwd">no</span><span class="pln"> &nbsp; &nbsp; &nbsp;</span><span class="lit">39</span><span class="pln"> &nbsp;</span><span class="lit">0</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln">LFIGLB</span><span class="pun">+</span><span class="typ">Arial</span><span class="pun">-</span><span class="typ">BoldMT</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Type</span><span class="pln"> </span><span class="lit">1C</span><span class="pln"> &nbsp; &nbsp; &nbsp; yes yes </span><span class="kwd">no</span><span class="pln"> &nbsp; &nbsp; &nbsp;</span><span class="lit">41</span><span class="pln"> &nbsp;</span><span class="lit">0</span></code></li></ol></pre>

<p><code>pdfinfo</code>
: extracts contents of <code>Info</code> dictionary in a PDF file. Another part of the <code>Xpdf</code> project.</p>

<p>Example:</p>

<pre class="prettyprint linenums"><ol class="linenums"><li class="L0"><code><span class="pln">pdfinfo filename</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L1"><code><span class="pln"></span><span class="typ">Title</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">HILs</span><span class="pun">.</span><span class="pln">pdf</span><br></code></li><li class="L2"><code><span class="pln"></span><span class="typ">Subject</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><span class="typ">Keywords</span><span class="pun">:</span><span class="pln"></span><br></code></li><li class="L4"><code><span class="pln"></span><span class="typ">Author</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; </span><br></code></li><li class="L5"><code><span class="pln"></span><span class="typ">Creator</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">Acrobat</span><span class="pln"> </span><span class="typ">PDFMaker</span><span class="pln"> </span><span class="lit">10.0</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="typ">Word</span><span class="pln"></span><br></code></li><li class="L6"><code><span class="pln"></span><span class="typ">Producer</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; </span><span class="typ">Acrobat</span><span class="pln"> </span><span class="typ">Distiller</span><span class="pln"> </span><span class="lit">9.3</span><span class="pun">.</span><span class="lit">0</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Windows</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L7"><code><span class="pln"></span><span class="typ">CreationDate</span><span class="pun">:</span><span class="pln"> &nbsp; </span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> &nbsp;</span><span class="lit">2</span><span class="pln"> </span><span class="lit">11</span><span class="pun">:</span><span class="lit">16</span><span class="pun">:</span><span class="lit">53</span><span class="pln"> </span><span class="lit">2014</span><span class="pln"></span><br></code></li><li class="L8"><code><span class="pln"></span><span class="typ">ModDate</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jun</span><span class="pln"> &nbsp;</span><span class="lit">2</span><span class="pln"> </span><span class="lit">11</span><span class="pun">:</span><span class="lit">16</span><span class="pun">:</span><span class="lit">53</span><span class="pln"> </span><span class="lit">2014</span><span class="pln"></span><br></code></li><li class="L9"><code><span class="pln"></span><span class="typ">Tagged</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">no</span><span class="pln"></span><br></code></li><li class="L0"><code><span class="pln"></span><span class="typ">Pages</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="lit">3</span><span class="pln"></span><br></code></li><li class="L1"><code><span class="pln"></span><span class="typ">Encrypted</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp;</span><span class="kwd">no</span><span class="pln"></span><br></code></li><li class="L2"><code><span class="pln"></span><span class="typ">Page</span><span class="pln"> size</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp;</span><span class="lit">612</span><span class="pln"> x </span><span class="lit">792</span><span class="pln"> pts </span><span class="pun">(</span><span class="pln">letter</span><span class="pun">)</span><span class="pln"></span><br></code></li><li class="L3"><code><span class="pln"></span><span class="typ">File</span><span class="pln"> size</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp;</span><span class="lit">39177</span><span class="pln"> bytes</span><br></code></li><li class="L4"><code><span class="pln"></span><span class="typ">Optimized</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; &nbsp;yes</span><br></code></li><li class="L5"><code><span class="pln">PDF version</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp;</span><span class="lit">1.5</span></code></li></ol></pre>

<h1>Summary</h1>

<p>There's some overlap in capability between <code>PDFMiner</code> and <code>PyPDF2</code>, but you'll still have to make a choice when deciding which to use and learn. Both libraries are in active development and the developers are dedicated to providing good code. Browsing the source is good way to learn about both Python and PDF internals.</p>

<p>There are some nasty PDFs out there, but there are several tools you can use to get what you need from them, and Python enables you to get inside and scrape, split, merge, delete, and crop just about whatever you find.</p>
		</div>
				<div class="related">
			<h2>Was this tutorial useful? Check out Video Converter:</h2>
			<a class="thumb-link" href="https://www.binpress.com/app/video-converter/360"><img class="thumb" src="2089fac900png-thumb.png" alt=""></a>
			<div class="summary"><p>A python module for video conversion, inspection and thumbnail generation, built on top of ffmpeg</p>
				<div class="rating"><span class="value-title" title="4"></span><ul title="Rating 4 out of 5"><li class="icon-star"></li><li class="icon-star"></li><li class="icon-star"></li><li class="icon-star"></li><li class="icon-star-empty"></li></ul></div>			</div>
			<a class="button" href="https://www.binpress.com/app/video-converter/360">More <i class="icon-angle-right"></i></a>
		</div>
				<div class="series">
					<a class="next" href="https://www.binpress.com/tutorial/pdfrw-the-other-python-PDF-library/171"><span class="book"></span> 
				<em>pdfrw: the other Python PDF library</em>
							</a>
						<a class="prev" href="https://www.binpress.com/tutorial/introduction-to-rate-limiting-with-redis-part-2/166"><span class="book"></span> 
				<em>Introduction to rate limiting with Redis [Part 2]</em>
								<small>6 comments</small>
							</a>
						
		</div>			
				<form class="subscribe-form" method="post" action="https://www.binpress.com/newsletter/signup">
			<img class="subscribe-icon" src="subscribe-big.png">
			<h3>Get new tutorials delivered to your Inbox</h3>
			<p>New tutorials will be sent to your Inbox once a week. You can unsubscribe at any time.</p>
			
			<input value="" name="name" placeholder="Full name" class="text" type="text"><input value="" name="email" placeholder="Email" class="text" type="text">			<input name="tutorial_id" value="167" type="hidden">
			<button type="submit" class="red-button icon-plane">Subscribe</button>
			
		</form>
		<div class="eoa-links">
			<a class="button floater" href="https://www.binpress.com/content/write-for-us"><i class="icon-pencil"></i>Write for us!</a>
			<a class="red-button" href="https://www.binpress.com/tutorials"><i class="icon-book-open"></i>More Tutorials</a>
		</div>
		<div class="social-buttons">
	<span class="share-link socialb"><a rel="nofollow" href="http://www.binpress.com/tutorial/manipulating-pdfs-with-python/167?slk"><em class="icon-link-1"></em><span class="counter">Link</span></a>
		<input value="http://www.binpress.com/tutorial/manipulating-pdfs-with-python/167" readonly="readonly" class="text" type="text">
	</span>
	<a attr-count="36" rel="nofollow" class="socialb facebook" href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167&amp;t=Manipulating+PDFs+with+Python+-+Tutorial+-+" count-url="https%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167" target="_top"><em class="icon-facebook"></em><span class="counter">36</span></a>
	<a rel="nofollow" class="socialb twitter" href="https://twitter.com/intent/tweet?text=Manipulating+PDFs+with+Python+-+Tutorial+-+&amp;url=http%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167" count-url="https%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167"><em class="icon-twitter"></em><span class="counter">Tweet</span></a>
	
	<a attr-count="2" rel="nofollow" class="socialb linkedin" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167&amp;title=Manipulating+PDFs+with+PythonTutorial&amp;source=Binpress" count-url="https%3A%2F%2Fwww.binpress.com%2Ftutorial%2Fmanipulating-pdfs-with-python%2F167"><em class="icon-linkedin"></em><span class="counter">2</span></a>

</div>		<div class="tutorial-comments">
	<a name="comments"></a>
	<h2>4 comments</h2>
	
		<div class="comment-form">
	
		<span class="avatar small"><img src="default-small.png" alt=""></span>		
		<form method="post" action="https://www.binpress.com/tutorials/comment">
			<input name="return" value="tutorial/manipulating-pdfs-with-python/167" type="hidden">
			<input name="tutorial_id" value="167" type="hidden">
			<input name="parent_id" type="hidden">
			<input name="reply_to" type="hidden">
			<textarea cols="50" rows="4" name="content"></textarea>
			<br>
			<div class="login">
	<small>Sign-in now</small>
	<a rel="nofollow" class="grey-button login-button" href="https://www.binpress.com/login?return=tutorial/manipulating-pdfs-with-python/167">Sign-in</a>
</div>
<div class="register">
	<small>Or enter your name and Email</small>
	<input value="" name="name" placeholder="Full name" class="text" type="text">
	<input name="email" placeholder="Email" class="text" type="email">	
	<span class="cld"><input name="4dac4b" value="5ce433" type="text"> <input value="" name="e365c9" type="text"></span></div>
<button type="submit">Send</button>
			
		</form>

	</div>

			
		<ul class="comments inline" data-action="tutorials/savecomment">
		<li id="comment287">
	<a name="comment287"></a>
	<div class="wrapper">
			
		
		<input name="comment_id" value="287" type="hidden">
				<a name="comment287"></a>
				<span class="avatar small color6"><img src="fdb247c945b52b6d495d18e4b4b19352" alt=""><span>FF</span></span>		<span class="author">Fernando Frana</span>
			
		
		<span class="time"><i class="icon-clock"></i>3 months ago</span>
				<blockquote class="comment">Very usefull, thanks a lot!</blockquote>
		
		
		<div class="actions">
						<a class="small-button grey-button reply icon-reply">Reply</a>
							
			<span class="right">
				<a class="icon-flag" rel="nofollow" href="https://www.binpress.com/app/flagcomment/id/287">Flag</a>
			</span>
		</div>
	</div>
		
	<ul class="replies">
		
		</ul>
	</li><li id="comment134">
	<a name="comment134"></a>
	<div class="wrapper">
			
		
		<input name="comment_id" value="134" type="hidden">
				<a name="comment134"></a>
				<span class="avatar small color6"><img src="1adde1d322b28694921c62db8be17c1f" alt=""><span>K</span></span>		<span class="author">kthakur</span>
			
		
		<span class="time"><i class="icon-clock"></i>1 year ago</span>
				<blockquote class="comment">Hi,
I tried using your merge recipe  to rotate counterclockwise, before merging, but it doesnt really work (I think it may be due to handling the pdf read as a stream?).

<a href="http://dpaste.com/2APHGV6" rel="nofollow">http://dpaste.com/2APHGV6</a>

I keep getting the error :

AttributeError: 'PageObject' object has no attribute 'seek'

</blockquote>
		
		
		<div class="actions">
						<a class="small-button grey-button reply icon-reply">Reply</a>
							
			<span class="right">
				<a class="icon-flag" rel="nofollow" href="https://www.binpress.com/app/flagcomment/id/134">Flag</a>
			</span>
		</div>
	</div>
		
	<ul class="replies">
		
			<li id="comment135">
	<a name="comment135"></a>
	<div class="wrapper">
			
		
		<input name="comment_id" value="135" type="hidden">
				<input name="parent_id" value="134" type="hidden">
				<a name="comment135"></a>
				<span class="avatar small color3"><img src="54a3f1ba4fe36ca8f3148c0c8a041d36_001.dat" alt=""><span>TA</span></span>		<span class="author">Tim Arnold</span>
			
		
		<span class="time"><i class="icon-clock"></i>1 year ago</span>
				<blockquote class="comment">hi @kthakur, thanks for writing. You are almost there, but the PdfFileMerger append method takes a PDF object, not a page object.  I think using the PdfFileWriter will be simpler. The following code creates a new PDF file from the rotated first pages, which I think you are going for:

from PyPDF2 import PdfFileWriter, PdfFileReader
import os

newpdf = PdfFileWriter()
files = [x for x in os.listdir('mypdfs') if x.endswith('.pdf')]
for fname in sorted(files):
    mypdfObj = PdfFileReader(open(os.path.join('mypdfs', fname), 'rb'))
    mypdfPg = mypdfObj.getPage(0)
    mypdfPgRt = mypdfPg.rotateCounterClockwise(90)
    newpdf.addPage(mypdfPgRt)
with open('output.pdf', 'wb') as f:
    newpdf.write(f)
</blockquote>
		
		
		<div class="actions">
						<a class="small-button grey-button reply icon-reply">Reply</a>
							
			<span class="right">
				<a class="icon-flag" rel="nofollow" href="https://www.binpress.com/app/flagcomment/id/135/parent/134">Flag</a>
			</span>
		</div>
	</div>
	</li><li id="comment136">
	<a name="comment136"></a>
	<div class="wrapper">
			
		
		<input name="comment_id" value="136" type="hidden">
				<input name="parent_id" value="134" type="hidden">
				<a name="comment136"></a>
				<span class="avatar small color6"><img src="1adde1d322b28694921c62db8be17c1f" alt=""><span>K</span></span>		<span class="author">kthakur</span>
			
		
		<span class="time"><i class="icon-clock"></i>1 year ago</span>
				<blockquote class="comment">Hi Tim,

Thanks! That fixed it and it works perfectly. I had been struggling with understanding how pypdf2 works. The documentation is a bit sparse and there are not too many examples available to help. Your article, though, is probably the most helpful.

Thanks again.</blockquote>
		
		
		<div class="actions">
						<a class="small-button grey-button reply icon-reply">Reply</a>
							
			<span class="right">
				<a class="icon-flag" rel="nofollow" href="https://www.binpress.com/app/flagcomment/id/136/parent/134">Flag</a>
			</span>
		</div>
	</div>
	</li>		</ul>
	</li>		</ul>		
		
	</div>
	</div>	
		
</div>			<div class="clear" style="clear: both;"></div>
		</div>
		<div id="footer-push"></div>
	</div>
	<div id="footer">
	<div class="footer-top">
		<div class="width">
			<a href="https://www.binpress.com/content/about">About us</a>
			<a href="https://www.binpress.com/contact">Contact Us</a>
			<a href="https://www.binpress.com/page/terms">Terms &amp; Conditions</a>
			<a href="https://www.binpress.com/page/privacy">Privacy Policy</a>
		</div>
	</div>
	<div class="width">

		<div class="col">
			<h3>Selling Digital Products</h3>
			<a href="https://www.binpress.com/features/store">Your Online Store</a>
			<a href="https://www.binpress.com/content/sell-software-online">Business Software</a>
			<a href="https://www.binpress.com/content/sell-games-online">Computer Games</a>
			<a href="https://www.binpress.com/content/sell-code-libraries">Source-Code Libraries</a>
			<a href="https://www.binpress.com/content/eu-vat-2015">EU VAT collection</a>
		</div>
		<div class="col">
			<h3>The Binpress Marketplace</h3>
			<a href="https://www.binpress.com/browse">Browse the marketplace</a>
			<a href="https://www.binpress.com/features/marketplace">Publish your products</a>
			<a href="https://www.binpress.com/content/guidelines">Publishing Guidelines</a>
			<a href="https://www.binpress.com/tutorials">Software Development Tutorials</a>
		</div>
		<div class="col">
			<h3>Learn More</h3>
			<a href="https://www.binpress.com/guides">Binpress Guides</a>
			<a href="https://www.binpress.com/blog">Blog</a>
			<a href="https://www.binpress.com/forum">Forum</a>
			<a href="https://www.binpress.com/content/faq">Frequently Asked Questions</a>
			<a href="https://www.binpress.com/dfp/start">Digital Fulfillment on your site</a>
		</div>

		<div class="social-profiles">
			<a class="icon-facebook social" href="https://www.facebook.com/binpress"></a>
			<a class="icon-twitter social" href="https://www.twitter.com/binpress"></a>
			<a class="icon-gplus social" href="https://plus.google.com/u/0/+Binpress/posts"></a>
			<a class="logo" href="https://www.binpress.com/" title="Homepage - Binpress">Your own digital store</a>
		</div>

	</div>
</div>	





		<!-- begin olark code --><!-- end olark code -->


<embed style="height: 0px; width: 0px; overflow: hidden; position: fixed; right: 100%;" allowscriptaccess="always" id="__mmapiwsFlash" src="device.swf"><span style="display: none;"><iframe src="index_2.html" id="_olark_framesocket54700" style="display: none ! important;"></iframe></span><div class="habla-browser-firefox habla-desktop olrk-noquirks" id="habla_beta_container_do_not_rely_on_div_classes_or_names"><div class="olrk-away" id="hbl_operator_state_div"><div class="olrk-normal" id="hbl_region"><div class=" olrk-state-compressed" id="habla_window_state_div"><div class="habla_window_div_base hbl_pal_main_width olrk-fixed-bottom olrk-fixed-left " style="margin: 0px 20px; bottom: 0px; left: 0px; display: none; position: fixed;" id="habla_window_div"><div style="display: block;" id="habla_compressed_div"></div><div class="habla_panel_border hbl_pal_main_bg hbl_pal_panel_border hbl_pal_main_font_family hbl_pal_main_font_size " style="display: block;" id="habla_panel_div"><div style="display: block;" id="habla_both_div"><div class="habla_topbar_div_normal hbl_pal_title_fg hbl_pal_title_bg habla_topbar_div_compressed " id="habla_topbar_div"><a class="habla_button habla_button_a_normal hbl_pal_header_font_size hbl_pal_main_font_family hbl_pal_button_bg hbl_pal_button_fg " id="habla_sizebutton_a">^</a><a class="habla_oplink_a_normal hbl_pal_header_font_size hbl_pal_title_fg " id="habla_oplink_a">Contact us!</a></div></div><div style="display: none;" id="habla_expanded_div"><div id="habla_middle_div"><div id="habla_middle_wrapper_div"><div class="hbl_panel habla_conversation_div hbl_pal_main_height hbl_pal_control_border hbl_pal_main_fg hbl_pal_main_bg   habla_conversation_message_on " style="height: 150px; overflow: hidden; display: none;" id="habla_conversation_div"><span id="hbl_body_message">Need help or have any questions? Lets talk about it!</span></div><div class="hbl_panel habla_offline_message_sent_div hbl_pal_main_height hbl_pal_control_border hbl_pal_main_fg " style="display: none;" id="habla_offline_message_sent_div">Thanks for your message!  We'll get back to you shortly.</div><div class="hbl_panel habla_offline_message_div hbl_pal_control_border hbl_pal_main_fg " style="display: block;" id="habla_offline_message_div"><span id="habla_offline_message_span">We're not around, but we'd love to chat another time.</span><div class="hbl_txt_wrapper"><textarea placeholder="<click here> and type your Name" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 20px; display: block;" name="habla_name_input" id="habla_name_input"></textarea></div><div class="hbl_txt_wrapper"><textarea placeholder="<click here> and type your Email" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 20px; display: block;" name="habla_offline_email_input" id="habla_offline_email_input"></textarea></div><div class="hbl_txt_wrapper"><textarea placeholder="We're not around but we still want to hear from you!  Leave us a note:" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 65px; display: block;" name="habla_offline_body_input" id="habla_offline_body_input"></textarea></div><span class="habla_offline_error_span " id="habla_offline_error_span"></span><input style="display: block;" value="Send" class="habla_offline_submit_input hbl_pal_offline_submit_fg hbl_pal_control_border hbl_pal_offline_submit_bg " name="habla_offline_submit_input" id="habla_offline_submit_input" type="submit"><div class="clear_style " id="habla_offline_clear_div"></div></div><div class="hbl_panel habla_pre_chat_div hbl_pal_main_height hbl_pal_main_fg " style="display: none; height: 150px;" id="habla_pre_chat_div"><span id="habla_pre_chat_span">Hi, I am around, click 'start chatting' to contact me.</span><div class="hbl_txt_wrapper"><textarea placeholder="<click here> and type your Name" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 20px; line-height: 20px;" name="habla_pre_chat_name_input" id="habla_pre_chat_name_input"></textarea></div><div class="hbl_txt_wrapper"><textarea placeholder="<click here> and type your Email" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 20px; line-height: 20px;" name="habla_pre_chat_email_input" id="habla_pre_chat_email_input"></textarea></div><div style="display: none;" class="hbl_txt_wrapper"><textarea placeholder="<click here> and type your Phone" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="height: 20px; line-height: 20px; display: none;" name="habla_pre_chat_phone_input" id="habla_pre_chat_phone_input"></textarea></div><span id="habla_pre_chat_error_span"></span><input value="Click here to start chatting" class="habla_pre_chat_form_field habla_offline_submit_input hbl_pal_offline_submit_fg hbl_pal_control_border hbl_pal_offline_submit_bg " name="habla_pre_chat_submit_input" id="habla_pre_chat_submit_input" type="submit"><div class="clear_style " id="habla_pre_chat_clear_div"></div></div></div><form style="display: none;" class="habla_chatform_form " autocomplete="off" method="GET" action="https://www.binpress.com/#" id="habla_chatform_form"><div class="habla_input_div " id="habla_input_div"><div class="hbl_txt_wrapper"><textarea disabled="" placeholder="Type here and hit <enter> to chat" class="habla_wcsend_field habla_wcsend_input_pre habla_wcsend_input_normal hbl_pal_input_pre_fg hbl_pal_main_font_family hbl_pal_input_font_size hbl_pal_control_border " style="line-height: 20px; height: 20px; display: none;" size="undefined" name="habla_wcsend_input" id="habla_wcsend_input"></textarea></div></div></form></div><div style="padding: 3px 0px 5px ! important; font-family: helvetica,sans-serif; text-align: center; text-transform: uppercase; font-size: 9px; letter-spacing: 2px; font-weight: bold; color: rgb(170, 170, 170) ! important; clear: both;"><span style="display: none;"><a style="font-family: helvetica, sans-serif; text-transform: uppercase; font-size: 9px !important; letter-spacing: 2px; font-weight: bold; color: #e75917 !important;" id="hblink9"></a>http://www.olark.com</span>Powered By <a rel="nofollow" style="font-family: helvetica,sans-serif; text-transform: uppercase; font-size: 9px ! important; letter-spacing: 2px; font-weight: bold; color: rgb(231, 89, 23) ! important;" href="http://www.olark.com/welcome/?rid=3407-350-10-2744&amp;rid=3407-350-10-2744&amp;utm_medium=widget&amp;utm_campaign=powered_by&amp;utm_source=3407-350-10-2744" id="hblink99" target="_top">Olark</a></div></div></div><div style="display: none;" id="habla_closed_div"></div></div></div></div></div></div></body>
</html>
